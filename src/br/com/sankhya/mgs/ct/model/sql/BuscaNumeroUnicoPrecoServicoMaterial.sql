SELECT NUCONTRMATSRV FROM (
SELECT NUCONTRMATSRV, NROOCORENCIA, MAX(NROOCORENCIA) OVER() AS MAXNROOCORENCIA
FROM MGSTCTCONTRVLRSERV
WHERE NUMCONTRATO = :NUMCONTRATO
AND NUMODALIDADE = :NUMODALIDADE
AND CODTPN = :CODTPN
AND CODEVENTO = :CODEVENTO
AND TRUNC(SYSDATE) BETWEEN DTINICIO AND DTFIM
AND ALIQISS = 0
) WHERE NROOCORENCIA = MAXNROOCORENCIA