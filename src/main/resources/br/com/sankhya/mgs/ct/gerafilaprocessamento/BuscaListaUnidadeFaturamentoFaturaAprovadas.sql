SELECT DISTINCT CUSTO.CODUNIDADEFATUR CODSITE
FROM MGSTCTLCTCUSTO CUSTO
INNER JOIN MGSTCTRLTANEXO ANEXO ON ANEXO.NURLTANEXO = CUSTO.NURLTANEXO
WHERE CUSTO.TIPGESTOR = 'G'
AND CUSTO.NUMFATURA IS NULL
AND NVL( ANEXO.APROVADO, 'N' ) = 'S'
AND CUSTO.CODTIPOFATURA = :CODTIPOFATURA
AND CUSTO.DTLANCCUSTO = :DTLANCCUSTO
AND CUSTO.CODUNIDADEFATUR >= :CODSITEI
AND CUSTO.CODUNIDADEFATUR <= :CODSITEF