SELECT
CHAVE, TO_NUMBER(SUBSTR(CHAVE,INSTR(CHAVE,'V_DTLCCUSTO')+12,8)) AS DATA
FROM MGSTCTFILAPROC
WHERE STATUS = 'I'
AND TO_CHAR(:CODUNIDADEFATUR) NOT IN ( CHAVE )
AND NUTIPOPROC = 16